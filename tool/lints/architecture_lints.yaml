# Architecture import boundaries (custom_lint).
#
# This file is the single source of truth for architecture import rules:
# - IDE linting via `custom_lint`
# - CLI/CI checks via `dart run custom_lint` (wired into tool/verify.dart)
#
# Patterns are POSIX globs, relative to the repository root (use `/`).
version: 1
package_name: mobile_core_kit

rules:
  # Strict rule: core should not depend on features (enforced by default).
  #
  # TODO(core-boundary): Refactor so `core/di/**` only imports `features/*/di/**`
  # and `core/session/**` no longer imports `features/user/**` (move shared user/session
  # types or introduce core-owned abstractions).
  - id: core_no_features
    reason: Core code must not import feature code (except explicitly allowlisted cases).
    from: lib/core/**
    deny:
      - lib/features/**
    exceptions:
      # Allowed: core DI composes feature modules.
      - from: lib/core/di/**
        allow:
          - lib/features/*/di/**

  # Clean Architecture boundaries inside features.
  - id: feature_domain_no_data_or_presentation
    reason: Domain must not depend on data/presentation (or navigation).
    from: lib/features/*/domain/**
    deny:
      - lib/features/*/data/**
      - lib/features/*/presentation/**
      - lib/navigation/**

  - id: feature_presentation_no_data
    reason: Presentation must not depend on data directly; go through usecases/repos.
    from: lib/features/*/presentation/**
    deny:
      - lib/features/*/data/**

  - id: feature_data_no_presentation_or_navigation
    reason: Data must not depend on presentation or navigation.
    from: lib/features/*/data/**
    deny:
      - lib/features/*/presentation/**
      - lib/navigation/**

  - id: navigation_no_feature_domain_or_data
    reason: Navigation composes UI only; it must not reach into feature domain/data.
    from: lib/navigation/**
    deny:
      - lib/features/*/domain/**
      - lib/features/*/data/**

  - id: feature_di_only_composed_from_core_di
    reason: Feature DI modules should only be imported by core DI composition.
    from: lib/**
    deny:
      - lib/features/*/di/**
    exceptions:
      - from: lib/core/di/**
        allow:
          - lib/features/*/di/**
